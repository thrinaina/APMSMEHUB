<!-- Loader -->
<app-loader *ngIf="isLoading"></app-loader>

<div class="dialog-container">
  <div class="dialog-header">
    <span>{{ 'Admin.CategoryApproval' | translate }}</span>
    <mat-icon (click)="onNoClick()">close</mat-icon>
  </div>

  <div class="dialog-body">
    <form [formGroup]="approvalForm">
      <div class="row g-3">

        <div class="col-md-12 d-flex flex-column row-gap-10">

          <div class="d-flex flex-column">

            <div class="d-flex my-2 justify-content-between ">
              <div class="d-flex flex-column gap-2">
                <span class="text-12">{{'Admin.RequestedDate' | translate}}</span>
                <span class="text-14 ms-3">{{data.requestData.requestDate | date: 'mediumDate'}}</span>
              </div>

              <div class="d-flex  flex-column gap-2">
                <span class="text-12">{{'Admin.RequestedBy' | translate}}</span>
                <span class="text-14 ms-3">{{data.requestData.userName}}</span>
              </div>

              <div>
                <div *ngIf="data.requestData.requestStatus == 'PENDING'" class="pending-chip">
                  {{( 'Common.'+data.requestData.requestStatus | titlecase)  | translate}}
                </div>
                <div *ngIf="data.requestData.requestStatus == 'REJECTED'" class="rejected-chip">
                  {{ ('Common.'+data.requestData.requestStatus | titlecase) | translate}}
                </div>
                <div *ngIf="data.requestData.requestStatus == 'ACCEPTED'" class="accepet-chip">
                  {{ ('Common.'+data.requestData.requestStatus  | titlecase) | translate}}
                </div>
              </div>
            </div>

            <div class="d-flex my-3 flex-column gap-2">
              <span class="text-12">{{'Admin.CategoryName' | translate}}</span>
              <span class="text-18 ms-3">{{data.requestData.requestedName}}</span>
            </div>

            <div class="d-flex my-2 flex-column gap-2">
              <span class="text-12">{{'Admin.Purposeofuse' | translate}} </span>
              <span class="text-14 ms-3">{{data.requestData.requestDescription}}</span>
            </div>

            <div *ngIf="data.requestData.requestStatus == 'ACCEPTED' || data.requestData.requestStatus == 'REJECTED'"
              class="d-flex my-2 flex-column gap-2">
              <span class="text-12" [ngClass]="{
                  'text-success': data.requestData.requestStatus?.toLowerCase() === 'accepted',
                  'text-danger': data.requestData.requestStatus?.toLowerCase() === 'rejected'
                }">
                {{ ('Common.'+data.requestData.requestStatus | titlecase ) | translate }}
                {{ 'Common.Remarks' | translate }}
              </span>

              <span class="text-14 ms-3">{{data.requestData.requestStatusRemarks}}</span>
            </div>
          </div>

          <!-- Remarks -->
          <div
            *ngIf="(data.requestData.requestStatus == 'ACCEPTED' && data.requestData.requestStatus == 'REJECTED') || data.requestData.requestStatus == 'PENDING'"
            class="col-md-12 mt-10">
            <mat-form-field appearance="outline" class="w-100" floatLabel="always">
              <mat-label>{{'Admin.StatusRemarks' | translate}}</mat-label>
              <textarea matInput type="text" rows="3" name="requestStatusRemarks"
                formControlName="requestStatusRemarks"></textarea>
            </mat-form-field>
            <div *ngIf="isSavedForm && approvalForm.invalid" class="error-div">
              <div *ngIf="approvalForm.controls['requestStatusRemarks'].errors?.['required']">
                {{'Admin.StatusRemarks' | translate}} {{'Common.RequiredError' | translate}}
              </div>
              <div *ngIf="approvalForm.controls['requestStatusRemarks'].errors?.['maxlength']">
                {{'Admin.StatusRemarks' | translate}} {{'Common.MaxLengthError' | translate}}
                {{approvalForm.controls['requestStatusRemarks'].errors?.['maxlength'].requiredLength}}
              </div>
              <div *ngIf="approvalForm.controls['requestStatusRemarks'].errors?.['pattern']">
                {{'Common.Invalid' | translate}} {{'Admin.StatusRemarks' | translate}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>

  <div
    *ngIf="(data.requestData.requestStatus == 'ACCEPTED' && data.requestData.requestStatus == 'REJECTED') || data.requestData.requestStatus == 'PENDING'"
    class="dialog-footer">
    <button type="button" class="btn btn-outline-primary" (click)="saveRequest('REJECTED')">{{'Common.Reject' |
      translate}}</button>
    <button type="button" class="btn btn-primary" (click)="saveRequest('ACCEPTED')">{{'Common.Approve' |
      translate}}</button>
  </div>
</div>
